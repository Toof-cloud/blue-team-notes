
# Metasploit Framework â€” Task 1  
## Introduction to Metasploit  
**TryHackMe Room Notes**

---

## ğŸ“Œ What is Metasploit?

Metasploit is the **most widely used exploitation framework** in cybersecurity.

It supports **all phases of penetration testing**, including:
- Information gathering
- Scanning
- Exploitation
- Payload delivery
- Post-exploitation
- Vulnerability research
- Exploit development

It is used in:
- Penetration testing
- Red teaming
- Vulnerability assessment
- Security research
- Exploit development labs

---

# ğŸ§± Metasploit Versions

## 1) Metasploit Pro
- Commercial version
- GUI-based
- Automation features
- Management dashboards
- Reporting tools
- Team collaboration features

## 2) Metasploit Framework (MSF)
- Open-source version
- Command-line interface (CLI)
- Installed on:
  - AttackBox
  - Kali Linux
  - Parrot OS
  - Most pentesting distros
- This room focuses on **Metasploit Framework**

---

# ğŸ§  What is Metasploit Framework?

Metasploit Framework is a **collection of tools** that allow:

- Information gathering  
- Scanning  
- Exploitation  
- Exploit development  
- Post-exploitation  
- Payload handling  
- Session management  

It is modular and extensible.

---

# ğŸ§© Core Components

## 1) msfconsole
**Main interface**
- Command-line environment
- Central control panel
- Used for:
  - Searching exploits
  - Loading modules
  - Setting options
  - Running attacks
  - Managing sessions

```bash
msfconsole
````

---

## 2) Modules

Modules are the building blocks of Metasploit.

### Types of modules:

* **Exploits** â†’ actual vulnerabilities
* **Payloads** â†’ what runs on target
* **Scanners** â†’ discovery tools
* **Auxiliary** â†’ support modules (bruteforce, fuzzing, enum)
* **Post** â†’ post-exploitation actions
* **Encoders** â†’ payload obfuscation
* **Nops** â†’ padding for exploit dev

---

## 3) Tools

Standalone tools included in Metasploit:

### Examples:

* `msfvenom` â†’ payload generator
* `pattern_create` â†’ exploit dev tool
* `pattern_offset` â†’ exploit dev tool

> Only **msfvenom** is covered in this room
> Others are for advanced exploit development

---

# ğŸ¯ Purpose of This Room

This room will teach you how to:

* Navigate Metasploit
* Use `msfconsole`
* Find relevant exploits
* Select modules
* Configure parameters
* Set payloads
* Exploit vulnerable services
* Understand workflow logic
* Use Metasploit comfortably in real labs

---

# ğŸ§­ Learning Outcome

After completing this room, you should be able to:

âœ” Navigate Metasploit CLI
âœ” Search for exploits
âœ” Understand module structure
âœ” Set exploit options
âœ” Configure payloads
âœ” Launch exploits
âœ” Manage sessions
âœ” Understand Metasploit workflow

---

# ğŸ–¥ï¸ Lab Setup Instructions

## Machines Required:

* AttackBox
* Target VM

### Steps:

1. Press **Start Machine**
2. Press **Start AttackBox**
3. Use **Split-Screen View**
4. If not visible â†’ click **Show Split View**

---

# ğŸ“ Task 1 Answers

```text
No answer needed
No answer needed
```

---

# ğŸ§  Concept Summary

```text
Metasploit = Framework
msfconsole = Control center
Modules = Functionality units
Tools = Stand-alone utilities
Framework version = CLI-based
Pro version = GUI-based
```

---

# ğŸ“š Keywords for Revision

```text
Metasploit
Metasploit Framework
Metasploit Pro
msfconsole
modules
payloads
exploits
scanners
auxiliary
post-exploitation
msfvenom
penetration testing
exploit framework
```

---

# ğŸ” Workflow Preview (High-Level)

```text
Recon â†’ Scan â†’ Find exploit â†’ Load module â†’ 
Set options â†’ Set payload â†’ Exploit â†’ Session â†’ Post-exploitation
```

---

# ğŸ›¡ï¸ Blue Team Awareness

Metasploit techniques simulate:

* Real attacker behavior
* Real exploitation paths
* Real attack chains
* Real post-exploitation activity

Used for:

* Defense testing
* SOC training
* Detection engineering
* Purple team exercises

---

# Metasploit Framework â€” Task 2  
## Main Components of Metasploit  
**TryHackMe Room Notes**

---

# ğŸ§  Core Concepts

Before using Metasploit modules, understand these three fundamental terms:

## ğŸ”“ Vulnerability
A **design, coding, or logic flaw** in a system.  
Exploiting a vulnerability can lead to:
- Information disclosure
- Unauthorized access
- Remote code execution
- Privilege escalation

---

## âš”ï¸ Exploit
A **piece of code** that takes advantage of a vulnerability on a target system.

> Exploit = the attack method

---

## ğŸ¯ Payload
The **code that runs on the target system** after exploitation.

> Payload = the result of the attack

Examples:
- Open a shell
- Run commands
- Add a user
- Install malware
- Launch `calc.exe`
- Create backdoors
- Extract data

---

# ğŸ§± Metasploit Architecture

Metasploit is built using **modules**.  
Each module performs a **specific task**.

You interact with them using:
```bash
msfconsole
````

---

# ğŸ“¦ Module Categories

---

## ğŸ§° Auxiliary Modules

**Purpose:** Support tasks (no direct exploitation)

Includes:

* Scanners
* Crawlers
* Fuzzers
* Parsers
* Sniffers
* Spoofers
* SQLi tools
* VoIP tools

```text
auxiliary/
â”œâ”€â”€ admin
â”œâ”€â”€ analyze
â”œâ”€â”€ crawler
â”œâ”€â”€ fuzzers
â”œâ”€â”€ gather
â”œâ”€â”€ scanner
â”œâ”€â”€ sniffer
â”œâ”€â”€ spoof
â”œâ”€â”€ sqli
â””â”€â”€ server
```

> Used for recon, scanning, enumeration, brute-force, fuzzing

---

## ğŸ” Encoders

**Purpose:** Encode payloads to evade signature-based detection

* Obfuscates exploit/payload
* Tries to bypass AV detection
* Limited effectiveness vs modern AV

```text
encoders/
â”œâ”€â”€ x86
â”œâ”€â”€ x64
â”œâ”€â”€ cmd
â”œâ”€â”€ php
â”œâ”€â”€ ruby
â””â”€â”€ generic
```

> Encoders â‰  true AV evasion

---

## ğŸ¥· Evasion Modules

**Purpose:** Actively bypass security controls

* More advanced than encoders
* Targets:

  * Windows Defender
  * AppLocker
  * Syscall detection
  * Behavioral detection

```text
evasion/windows/
â”œâ”€â”€ applocker_evasion_msbuild.rb
â”œâ”€â”€ windows_defender_exe.rb
â”œâ”€â”€ process_herpaderping.rb
â””â”€â”€ syscall_inject.rb
```

> Evasion = active defense bypass techniques

---

## ğŸ’¥ Exploits

**Purpose:** Actual vulnerability exploitation code

Organized by OS/platform:

```text
exploits/
â”œâ”€â”€ windows
â”œâ”€â”€ linux
â”œâ”€â”€ unix
â”œâ”€â”€ android
â”œâ”€â”€ osx
â”œâ”€â”€ multi
â””â”€â”€ bsd
```

> Exploits = attack entry point

---

## ğŸ§¬ NOPs (No Operation)

**Purpose:** Buffer padding for exploit development

* CPU instruction that does nothing
* Used for:

  * Buffer overflow alignment
  * Payload size consistency
  * Memory layout control

```text
nops/
â”œâ”€â”€ x86
â”œâ”€â”€ x64
â”œâ”€â”€ armle
â”œâ”€â”€ mipsbe
â””â”€â”€ sparc
```

> Mainly used in exploit development

---

## ğŸ¯ Payloads

**Purpose:** Code executed on the target system

### Payload Structure:

```text
payloads/
â”œâ”€â”€ adapters
â”œâ”€â”€ singles
â”œâ”€â”€ stagers
â””â”€â”€ stages
```

---

### ğŸ” Adapters

Wrap payloads into other formats
Example: Powershell wrapper

> Converts payload into different execution formats

---

### ğŸ“¦ Singles (Inline Payloads)

Self-contained payloads
No download needed

Examples:

* Add user
* Open shell
* Launch program
* Run command

> Entire payload sent at once

---

### ğŸ”— Stagers

Small initial payload
Creates communication channel

> Prepares connection for stage download

---

### ğŸ“¥ Stages

Main payload downloaded after stager

> Larger payload component

---

# ğŸ§  Payload Type Identification

### Inline (Single) Payload:

```text
generic/shell_reverse_tcp
```

### Staged Payload:

```text
windows/x64/shell/reverse_tcp
```

### Rule:

```text
_  = single (inline)
 / = staged
```

---

## ğŸ§© Post Modules

**Purpose:** Post-exploitation

Used after gaining access:

```text
post/
â”œâ”€â”€ windows
â”œâ”€â”€ linux
â”œâ”€â”€ multi
â”œâ”€â”€ networking
â””â”€â”€ osx
```

Examples:

* Credential dumping
* Persistence
* Lateral movement
* Privilege escalation
* Data exfiltration
* System enumeration

---

# ğŸ—‚ï¸ Module Location (AttackBox)

```bash
/opt/metasploit-framework/embedded/framework/modules
```

---

# ğŸ“ Task 2 Answers

```text
Exploit
Payload
Singles
Singles
```

---

# ğŸ§  Concept Mapping

```text
Vulnerability â†’ Exploit â†’ Payload â†’ Session â†’ Post-exploitation
```

---

# ğŸ” Metasploit Attack Flow

```text
Scan â†’ Find vuln â†’ Select exploit â†’ 
Set options â†’ Set payload â†’ Exploit â†’ 
Session â†’ Post modules
```

---

# ğŸ“š Keywords for Revision

```text
Exploit
Vulnerability
Payload
Auxiliary
Encoders
Evasion
NOPs
Stager
Stage
Singles
Adapters
Post-exploitation
msfconsole
Metasploit modules
```

---

# ğŸ›¡ï¸ Blue Team View

Metasploit simulates:

* Real attacker workflows
* Real exploit chains
* Real malware delivery paths
* Real post-exploitation activity

Used for:

* SOC training
* Detection engineering
* Purple teaming
* Threat simulation
* Defensive validation


---

# Metasploit Framework â€” Task 3  
## msfconsole  
**TryHackMe Room Notes**

---

# ğŸ–¥ï¸ msfconsole

`msfconsole` is the **main interface** to the Metasploit Framework.

Launch it using:
```bash
msfconsole
````

Once launched, the prompt changes to:

```text
msf6 >
```

(or `msf5 >` depending on version)

This indicates you are now inside the Metasploit console environment.

---

# ğŸ§  msfconsole as a Shell

msfconsole behaves like a Linux shell:

### Supported:

```bash
ls
ping -c 1 8.8.8.8
clear
```

### Example:

```bash
msf6 > ls
msf6 > ping -c 1 8.8.8.8
```

---

## âŒ Unsupported Features

Some Linux shell features are **not supported**:

```bash
help > help.txt
```

âŒ Output redirection not supported
âŒ Piping not supported

---

# ğŸ“– Help System

### General help:

```bash
help
```

### Command-specific help:

```bash
help set
```

Example output explains:

* syntax
* options
* global vs local scope
* module datastore
* payload indexing

---

# ğŸ§¾ Command History

```bash
history
```

Shows previously executed commands inside msfconsole.

---

# âš¡ Tab Completion

msfconsole supports **tab auto-complete**:

```text
he + TAB  â†’ help
```

Works for:

* commands
* modules
* payloads
* options
* paths

---

# ğŸ§­ Context System

Metasploit works using **contexts**.

When you load a module:

```bash
use exploit/windows/smb/ms17_010_eternalblue
```

Prompt changes to:

```text
msf6 exploit(windows/smb/ms17_010_eternalblue) >
```

This means:

* You are now inside that moduleâ€™s context
* All settings apply only to this module
* Switching modules resets non-global settings

---

# ğŸ§¨ Example: EternalBlue Context

```bash
use exploit/windows/smb/ms17_010_eternalblue
```

Default payload auto-selected:

```text
windows/x64/meterpreter/reverse_tcp
```

---

# ğŸ“‹ show options

```bash
show options
```

Displays:

* Required options
* Optional options
* Current settings
* Payload settings
* Target systems

### Example fields:

```text
RHOSTS
RPORT
LHOST
LPORT
SMBUser
SMBPass
```

---

# ğŸ” Context Behavior

If you change module:

```bash
use auxiliary/scanner/portscan/tcp
```

You must **re-set options** like `RHOSTS`, because:

* settings are **context-specific**
* not global by default

---

# ğŸ“¦ show payloads

```bash
show payloads
```

Shows **compatible payloads** for the current exploit module.

---

# ğŸ“¤ Leaving a Context

```bash
back
```

Returns to:

```text
msf6 >
```

---

# â„¹ï¸ info Command

Inside a module:

```bash
info
```

Shows:

* Module name
* Description
* Authors
* References
* CVEs
* Targets
* Options
* Payload space
* Exploit reliability
* Disclosure date

Or directly:

```bash
info exploit/windows/smb/ms17_010_eternalblue
```

---

# ğŸ” search Command

Search the Metasploit database:

```bash
search ms17-010
search apache
search heartbleed
search cve:2017-0144
```

---

## ğŸ¯ Search Filters

```bash
search type:auxiliary telnet
search platform:windows
search type:exploit apache
```

### Common filters:

```text
type:
platform:
cve:
name:
rank:
```

---

# ğŸ·ï¸ Exploit Ranking System

Each exploit has a **rank** (reliability level):

```text
Excellent
Great
Good
Normal
Average
Low
Manual
```

âš ï¸ Important:

* High rank â‰  guaranteed success
* Low rank â‰  useless
* Some exploits crash systems
* Some excellent exploits fail
* Real-world exploitation is unpredictable

---

# ğŸ§  Metasploit Workflow (Task 3 Focus)

```text
Launch msfconsole
â†’ search module
â†’ use module
â†’ show options
â†’ set parameters
â†’ show payloads
â†’ set payload
â†’ run / exploit
â†’ session
â†’ post-exploitation
```

---

# ğŸ“ Task 3 Answers

```text
search apache
todb
```

---

# ğŸ§  Core Commands Summary

```text
msfconsole      â†’ start framework
search          â†’ find modules
use             â†’ load module
show options    â†’ view settings
show payloads   â†’ list payloads
set             â†’ set value
unset           â†’ remove value
run / exploit   â†’ execute module
back            â†’ exit module context
info            â†’ module details
history         â†’ command history
help            â†’ command help
```

---

# ğŸ›¡ï¸ Blue Team Insight

msfconsole simulates:

* Real attacker tooling
* Real exploitation workflows
* Real attack automation
* Real post-exploitation behavior

Used for:

* Detection engineering
* SOC training
* Purple team labs
* Threat simulation
* Red team ops

---

# ğŸ“š Keywords for Review

```text
msfconsole
context
modules
use
search
show options
show payloads
info
rank
exploit ranking
tab completion
metasploit workflow
```

---

# Metasploit Framework â€” Task 4  
## Working with Modules  
**TryHackMe Room Notes**

---

# ğŸ¯ Working with Modules

Once inside a module context using:
```bash
use <module_path>
````

You must configure parameters before running the module.

All parameters use the syntax:

```bash
set PARAMETER_NAME VALUE
```

---

# ğŸ§­ Metasploit Prompt Types

Understanding prompts is critical:

### 1ï¸âƒ£ Regular Linux Shell

```text
root@ip-10-10-XX-XX:~#
```

âŒ Cannot use Metasploit commands here

---

### 2ï¸âƒ£ msfconsole Prompt

```text
msf6 >
```

âœ” Metasploit active
âŒ No module context yet

---

### 3ï¸âƒ£ Module Context Prompt

```text
msf6 exploit(windows/smb/ms17_010_eternalblue) >
```

âœ” Can set parameters
âœ” Can run exploit
âœ” Context-specific commands enabled

---

### 4ï¸âƒ£ Meterpreter Prompt

```text
meterpreter >
```

âœ” Post-exploitation agent
âœ” Meterpreter commands only

---

### 5ï¸âƒ£ Target System Shell

```text
C:\Windows\system32>
```

âœ” Commands run on victim system
âœ” Native OS shell

---

# ğŸ“‹ show options

Displays required and optional parameters:

```bash
show options
```

Shows:

* Module options
* Payload options
* Exploit targets

---

# âš™ï¸ Setting Parameters

Example:

```bash
set RHOSTS 10.10.165.39
```

Verify:

```bash
show options
```

---

# ğŸ§© Common Parameters

| Parameter | Meaning             |
| --------- | ------------------- |
| `RHOSTS`  | Target IP / range   |
| `RPORT`   | Target service port |
| `PAYLOAD` | Payload used        |
| `LHOST`   | Attacker IP         |
| `LPORT`   | Attacker port       |
| `SESSION` | Active session ID   |

---

# ğŸ” Overriding Values

```bash
set RPORT 8080
```

---

# âŒ Clearing Values

```bash
unset PARAMETER
```

Clear all:

```bash
unset all
```

---

# ğŸŒ Global Parameters (setg)

```bash
setg PARAMETER VALUE
```

Example:

```bash
setg RHOSTS 10.10.165.39
```

âœ” Persists across modules
âœ” Saves time
âœ” Global scope

Clear global:

```bash
unsetg RHOSTS
```

---

# ğŸ§­ Module Navigation Flow

```text
use exploit
â†’ setg RHOSTS
â†’ back
â†’ use auxiliary
â†’ show options
```

RHOSTS auto-filled âœ…

---

# ğŸš€ Running Modules

```bash
exploit
```

Alias:

```bash
run
```

---

# ğŸ’¤ Background Execution

```bash
exploit -z
```

âœ” Exploits target
âœ” Backgrounds session automatically

---

# ğŸ§ª Vulnerability Check Mode

Some modules support:

```bash
check
```

âœ” Tests vulnerability
âŒ No exploitation

---

# ğŸ§· Sessions

After exploitation, a session is created.

---

## ğŸ“‹ List Sessions

```bash
sessions
```

---

## ğŸ”™ Background Session

```bash
background
```

or:

```bash
CTRL + Z
```

---

## ğŸ¯ Interact with Session

```bash
sessions -i <ID>
```

Example:

```bash
sessions -i 2
```

---

# ğŸ§  Exploitation Workflow

```text
use module
â†’ show options
â†’ set parameters
â†’ exploit / run
â†’ session created
â†’ background session
â†’ sessions -i
â†’ post-exploitation
```

---

# ğŸ“ Task 4 Answers

```text
Q: How would you set the LPORT value to 6666?
A: set LPORT 6666

Q: How would you set the global value for RHOSTS to 10.10.19.23 ?
A: setg RHOSTS 10.10.19.23

Q: What command would you use to clear a set payload?
A: unset PAYLOAD

Q: What command do you use to proceed with the exploitation phase?
A: exploit
```

---

# ğŸ§  Core Commands Summary

```text
use
set
setg
unset
unset all
unsetg
show options
exploit
run
check
back
sessions
sessions -i
background
```

---

# ğŸ›¡ï¸ Security Insight

This workflow mirrors **real-world attacker behavior**:

* Enumeration
* Parameter configuration
* Exploitation
* Session handling
* Persistence preparation
* Post-exploitation movement

Used in:

* Red Team ops
* Purple Team labs
* SOC simulations
* Detection engineering
* DFIR training

---

# ğŸ“š Keywords

```text
modules
set
setg
unset
global parameters
context
sessions
meterpreter
payload
exploitation phase
post-exploitation
```



